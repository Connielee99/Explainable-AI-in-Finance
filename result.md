## Navigation 
- <a href = "https://connielee99.github.io/Explainable-AI-in-Finance">HomePage</a>
- <a href = "https://connielee99.github.io/Explainable-AI-in-Finance/abstract">Project Details</a>
  - <a href = "https://connielee99.github.io/Explainable-AI-in-Finance/introduction">Introduction</a>
  - <a href = "https://connielee99.github.io/Explainable-AI-in-Finance/stockmarket">Stock Market</a>
  - <a href = "https://connielee99.github.io/Explainable-AI-in-Finance/result">Prediction Result</a>
- <a href = "https://connielee99.github.io/Explainable-AI-in-Finance/methodology">Technical Methodology</a>
	- <a href = "https://connielee99.github.io/Explainable-AI-in-Finance/gaf">Gramian Angular Field</a> 
	- <a href = "https://connielee99.github.io/Explainable-AI-in-Finance/fastai">FastAI CNN Model</a>
	- <a href = "https://connielee99.github.io/Explainable-AI-in-Finance/gradcam">Grad-CAM Algorithm</a>

## Model Training Results

After the training procedure described above, the CNN model constantly achieves around **62% accuracy** on the validation set. The figure below shows the confusion matrix of our final model. We can observe that the model works quite equally for both of the two classes with the false positive rate being a little bit higher than the false negative rate.

<p align="center">
    <img src="img/report_img/confusion_matrix.png" alt="layers arch" width=400>
    <br>The Confusion Matrix of the Final Model

The figure below are some sample instances from the validation results. Again, the class “1” means the index price went up that given day and the class “0” indicates the opposite.
    
<p align="center">
    <img src="img/report_img/cnn_results.png" alt="layers arch" width=400>
    <br>Prediction Results for Some Instance in Validation Set
	
</p>

## Grad CAM Results
<p align='justify'>
This section summarizes results generated by applying the Grad-CAM Algorithm over our Gramian Angular Field converted time series data. <br>

Results shown below are made available by leveraging third-party Grad-CAM API instead of using Grad-CAM algorithm we trained ourselves (<a href = https://github.com/kazuto1011/grad-cam-pytorch#demo-1>Source</a>). This interface is favored over ours due to it enabling additional visualizations for inspection – that include Guided Grad-CAM, gradients by vanilla backpropagation, gradients by guided backpropagation, and gradients by deconvnet. Trained on a different image database but sharing the same internal architecture of ResNet-34, we specify the target layer, i.e., layer4 in the algorithm for visualization. For there are only two classes in our prediction task, outputs on only the top 1 class of two sample images are generated.<br>

</p>
<b>Visual Explanation from Various Algorithms<br></b>


| Predicted Class = 1 | GAF Image: 2017-01-03 | GAF Image: 2021-01-01 |
| --- | --- | --- |
| Original Image | <img src="img/test_imgs/2017-01-03.png" alt="test1" width=250> | <img src="img/test_imgs/2021-01-01.png" alt="test2" width=250> |
| Grad-CAM | <img src="img/class1_layer4_2017-01-03/0-resnet34-gradcam-layer4-oscilloscope.png" alt="test11" width=250> | <img src="img/class1_layer4_2021-01-01/0-resnet34-gradcam-layer4-digital_clock.png" alt="test21" width=250> |
| Vanilla Backpropagation | <img src="img/class1_layer4_2017-01-03/0-resnet34-vanilla-oscilloscope.png" alt="test12" width=250> | <img src="img/class1_layer4_2021-01-01/0-resnet34-vanilla-digital_clock.png" alt="test22" width=250> |
| DeconvNet | <img src="img/class1_layer4_2017-01-03/0-resnet34-deconvnet-oscilloscope.png" alt="test13" width=250> | <img src="img/class1_layer4_2021-01-01/0-resnet34-deconvnet-digital_clock.png" alt="test23" width=250> |
| Guided Backpropagation | <img src="img/class1_layer4_2017-01-03/0-resnet34-guided-oscilloscope.png" alt="test14" width=250> | <img src="img/class1_layer4_2021-01-01/0-resnet34-guided-digital_clock.png" alt="test24" width=250> |
| Guided Grad-CAM | <img src="img/class1_layer4_2017-01-03/0-resnet34-guided_gradcam-layer4-oscilloscope.png" alt="test15" width=250> | <img src="img/class1_layer4_2021-01-01/0-resnet34-guided_gradcam-layer4-digital_clock.png" alt="test25" width=250> |
